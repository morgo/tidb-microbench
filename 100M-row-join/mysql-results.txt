The loader was canceled at 10M rows in order to fit the data in memory (I had a 54GB buffer pool on a 64GB system).
I also set innodb_old_blocks_time to zero so the buffer pool could fill.

** First Test **

mysql> SELECT STRAIGHT_JOIN t1.* FROM t2 INNER JOIN t1 ON t2.table1id=t1.id WHERE t1.id=0;
Empty set (3.42 sec)

mysql> EXPLAIN SELECT STRAIGHT_JOIN t1.* FROM t2 INNER JOIN t1 ON t2.table1id=t1.id WHERE t1.id=0;
+----+-------------+-------+------------+-------+---------------+---------+---------+-------+---------+----------+-------------+
| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref   | rows    | filtered | Extra       |
+----+-------------+-------+------------+-------+---------------+---------+---------+-------+---------+----------+-------------+
|  1 | SIMPLE      | t2    | NULL       | ALL   | NULL          | NULL    | NULL    | NULL  | 8009755 |    10.00 | Using where |
|  1 | SIMPLE      | t1    | NULL       | const | PRIMARY       | PRIMARY | 4       | const |       1 |   100.00 | NULL        |
+----+-------------+-------+------------+-------+---------------+---------+---------+-------+---------+----------+-------------+
2 rows in set, 1 warning (0.01 sec)


mysql> SELECT STRAIGHT_JOIN t1.* FROM t1 INNER JOIN t2 ON t2.table1id=t1.id WHERE t2.id=0;
Empty set (11.39 sec)

mysql> explain SELECT STRAIGHT_JOIN t1.* FROM t1 INNER JOIN t2 ON t2.table1id=t1.id WHERE t2.id=0;
+----+-------------+-------+------------+-------+---------------+---------+---------+-------+---------+----------+-------------+
| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref   | rows    | filtered | Extra       |
+----+-------------+-------+------------+-------+---------------+---------+---------+-------+---------+----------+-------------+
|  1 | SIMPLE      | t1    | NULL       | ALL   | PRIMARY       | NULL    | NULL    | NULL  | 8289277 |   100.00 | NULL        |
|  1 | SIMPLE      | t2    | NULL       | const | PRIMARY       | PRIMARY | 4       | const |       1 |    10.00 | Using where |
+----+-------------+-------+------------+-------+---------------+---------+---------+-------+---------+----------+-------------+
2 rows in set, 1 warning (0.00 sec)


** Second Test **

I repeated this because I thought it was interesting (but skewed - mysql applies charset/collation, versus TiDB which is only binary collation).
Because the rows are short, even though the columns are defined blob they will inline.

InnoDB was going crazy: 1.1M reads/s (in memory, single threaded nested loop join, all in memory).

mysql> EXPLAIN SELECT STRAIGHT_JOIN t1.* FROM t2 INNER JOIN t1 ON t2.table1id=t1.id WHERE t1.b='aaa';
+----+-------------+-------+------------+--------+---------------+---------+---------+------------------+---------+----------+-------------+
| id | select_type | table | partitions | type   | possible_keys | key     | key_len | ref              | rows    | filtered | Extra       |
+----+-------------+-------+------------+--------+---------------+---------+---------+------------------+---------+----------+-------------+
|  1 | SIMPLE      | t2    | NULL       | ALL    | NULL          | NULL    | NULL    | NULL             | 7453506 |   100.00 | NULL        |
|  1 | SIMPLE      | t1    | NULL       | eq_ref | PRIMARY       | PRIMARY | 4       | test.t2.table1id |       1 |    10.00 | Using where |
+----+-------------+-------+------------+--------+---------------+---------+---------+------------------+---------+----------+-------------+
2 rows in set, 1 warning (0.00 sec)

mysql> SELECT STRAIGHT_JOIN t1.* FROM t2 INNER JOIN t1 ON t2.table1id=t1.id WHERE t1.b='aaa';
Empty set (21.80 sec)

mysql> EXPLAIN SELECT STRAIGHT_JOIN t1.* FROM t2 INNER JOIN t1 ON t2.table1id=t1.id WHERE t1.b='aaa';
+----+-------------+-------+------------+--------+---------------+---------+---------+------------------+---------+----------+-------------+
| id | select_type | table | partitions | type   | possible_keys | key     | key_len | ref              | rows    | filtered | Extra       |
+----+-------------+-------+------------+--------+---------------+---------+---------+------------------+---------+----------+-------------+
|  1 | SIMPLE      | t2    | NULL       | ALL    | NULL          | NULL    | NULL    | NULL             | 7453506 |   100.00 | NULL        |
|  1 | SIMPLE      | t1    | NULL       | eq_ref | PRIMARY       | PRIMARY | 4       | test.t2.table1id |       1 |    10.00 | Using where |
+----+-------------+-------+------------+--------+---------------+---------+---------+------------------+---------+----------+-------------+
2 rows in set, 1 warning (0.00 sec)

mysql> SELECT STRAIGHT_JOIN t1.* FROM t1 INNER JOIN t2 ON t2.table1id=t1.id WHERE t2.b='aaa';
** Cancelled after 600 seconds - it didn't finish ***

